{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link}from'react-router-dom';import axios from'axios';import'./Pages.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const OrderHistory=()=>{const[orders,setOrders]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{const fetchOrders=async()=>{try{setLoading(true);const token=localStorage.getItem('weKnowToken');if(!token){setError('Please login to view your orders');setLoading(false);return;}const response=await axios.get('http://localhost:8000/user/orders',{headers:{'Authorization':`Bearer ${token}`}});if(response.data.success){console.log('Orders fetched successfully:',response.data.orders);setOrders(response.data.orders||[]);}else{console.error('Failed to load orders:',response.data.error);setError(response.data.error||'Failed to load orders');}}catch(err){var _err$response,_err$response2;console.error('Error fetching orders:',err);console.error('Error response:',(_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data);if(((_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.status)===401){setError('Please login to view your orders');}else{setError('Failed to load orders. Please try again.');}}finally{setLoading(false);}};fetchOrders();},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"page-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"page-header\",children:[/*#__PURE__*/_jsx(Link,{to:\"/\",className:\"back-button\",children:\"\\u2190 Back to Home\"}),/*#__PURE__*/_jsx(\"h1\",{children:\"Order History\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"page-content\",children:loading?/*#__PURE__*/_jsxs(\"div\",{className:\"loading-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading your orders...\"})]}):error?/*#__PURE__*/_jsxs(\"div\",{className:\"error-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"error-icon\",children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"Error Loading Orders\"}),/*#__PURE__*/_jsx(\"p\",{children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.location.reload(),className:\"retry-button\",children:\"Try Again\"})]}):orders.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"orders-list\",children:orders.map(order=>/*#__PURE__*/_jsxs(\"div\",{className:\"order-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"order-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:order.dish_name}),/*#__PURE__*/_jsx(\"span\",{className:`status-badge ${(order.status||'pending').toLowerCase()}`,children:order.status||'Pending'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-details\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Order ID:\"}),\" \",order.id||'N/A']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Date:\"}),\" \",order.timestamp?new Date(order.timestamp).toLocaleDateString():'N/A']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Servings:\"}),\" \",order.servings||2]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ingredients-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Ingredients Delivered:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"ingredients-tags\",children:order.ingredients&&order.ingredients.length>0?order.ingredients.map((ingredient,index)=>{const quantity=ingredient.quantity;const unit=ingredient.unit||'';const name=ingredient.ingredient||ingredient.name||'Unknown ingredient';return/*#__PURE__*/_jsxs(\"span\",{className:\"ingredient-tag\",children:[quantity!==null?`${quantity} ${unit} `:'',name]},index);}):/*#__PURE__*/_jsx(\"span\",{className:\"ingredient-tag\",children:\"No ingredients available\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"action-button\",children:\"Reorder\"}),/*#__PURE__*/_jsx(\"button\",{className:\"action-button secondary\",children:\"View Details\"})]})]},order.id))}):/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"empty-icon\",children:\"\\uD83D\\uDCE6\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"No Orders Yet\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Your completed orders will appear here\"}),/*#__PURE__*/_jsx(Link,{to:\"/\",className:\"cta-button\",children:\"Start Your First Order\"})]})})]});};export default OrderHistory;","map":{"version":3,"names":["React","useState","useEffect","Link","axios","jsx","_jsx","jsxs","_jsxs","OrderHistory","orders","setOrders","loading","setLoading","error","setError","fetchOrders","token","localStorage","getItem","response","get","headers","data","success","console","log","err","_err$response","_err$response2","status","className","children","to","onClick","window","location","reload","length","map","order","dish_name","toLowerCase","id","timestamp","Date","toLocaleDateString","servings","ingredients","ingredient","index","quantity","unit","name"],"sources":["/Users/roshan/Desktop/we_know_sample_2/frontend/src/pages/OrderHistory.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\nimport './Pages.css';\n\nconst OrderHistory = () => {\n  const [orders, setOrders] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    const fetchOrders = async () => {\n      try {\n        setLoading(true);\n        const token = localStorage.getItem('weKnowToken');\n        \n        if (!token) {\n          setError('Please login to view your orders');\n          setLoading(false);\n          return;\n        }\n\n        const response = await axios.get('http://localhost:8000/user/orders', {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n\n        if (response.data.success) {\n          console.log('Orders fetched successfully:', response.data.orders);\n          setOrders(response.data.orders || []);\n        } else {\n          console.error('Failed to load orders:', response.data.error);\n          setError(response.data.error || 'Failed to load orders');\n        }\n      } catch (err) {\n        console.error('Error fetching orders:', err);\n        console.error('Error response:', err.response?.data);\n        if (err.response?.status === 401) {\n          setError('Please login to view your orders');\n        } else {\n          setError('Failed to load orders. Please try again.');\n        }\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchOrders();\n  }, []);\n\n  return (\n    <div className=\"page-container\">\n      <div className=\"page-header\">\n        <Link to=\"/\" className=\"back-button\">\n          ‚Üê Back to Home\n        </Link>\n        <h1>Order History</h1>\n      </div>\n\n      <div className=\"page-content\">\n        {loading ? (\n          <div className=\"loading-state\">\n            <div className=\"loading-spinner\"></div>\n            <p>Loading your orders...</p>\n          </div>\n        ) : error ? (\n          <div className=\"error-state\">\n            <div className=\"error-icon\">‚ö†Ô∏è</div>\n            <h3>Error Loading Orders</h3>\n            <p>{error}</p>\n            <button onClick={() => window.location.reload()} className=\"retry-button\">\n              Try Again\n            </button>\n          </div>\n        ) : orders.length > 0 ? (\n          <div className=\"orders-list\">\n            {orders.map((order) => (\n              <div key={order.id} className=\"order-card\">\n                <div className=\"order-header\">\n                  <h3>{order.dish_name}</h3>\n                  <span className={`status-badge ${(order.status || 'pending').toLowerCase()}`}>\n                    {order.status || 'Pending'}\n                  </span>\n                </div>\n                \n                <div className=\"order-details\">\n                  <p><strong>Order ID:</strong> {order.id || 'N/A'}</p>\n                  <p><strong>Date:</strong> {order.timestamp ? new Date(order.timestamp).toLocaleDateString() : 'N/A'}</p>\n                  <p><strong>Servings:</strong> {order.servings || 2}</p>\n                </div>\n\n                <div className=\"ingredients-section\">\n                  <h4>Ingredients Delivered:</h4>\n                  <div className=\"ingredients-tags\">\n                    {order.ingredients && order.ingredients.length > 0 ? (\n                      order.ingredients.map((ingredient, index) => {\n                        const quantity = ingredient.quantity;\n                        const unit = ingredient.unit || '';\n                        const name = ingredient.ingredient || ingredient.name || 'Unknown ingredient';\n                        \n                        return (\n                          <span key={index} className=\"ingredient-tag\">\n                            {quantity !== null ? `${quantity} ${unit} ` : ''}{name}\n                          </span>\n                        );\n                      })\n                    ) : (\n                      <span className=\"ingredient-tag\">No ingredients available</span>\n                    )}\n                  </div>\n                </div>\n\n                <div className=\"order-actions\">\n                  <button className=\"action-button\">Reorder</button>\n                  <button className=\"action-button secondary\">View Details</button>\n                </div>\n              </div>\n            ))}\n          </div>\n        ) : (\n          <div className=\"empty-state\">\n            <div className=\"empty-icon\">üì¶</div>\n            <h3>No Orders Yet</h3>\n            <p>Your completed orders will appear here</p>\n            <Link to=\"/\" className=\"cta-button\">\n              Start Your First Order\n            </Link>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default OrderHistory; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}