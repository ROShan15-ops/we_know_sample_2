{"ast":null,"code":"import React,{useState,useEffect,useCallback,useRef}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const LoginModal=_ref=>{let{isOpen,onClose,onLogin}=_ref;const[loginData,setLoginData]=useState({email:'',password:''});const[authError,setAuthError]=useState('');const emailRef=useRef(null);const passwordRef=useRef(null);useEffect(()=>{if(isOpen&&emailRef.current){setTimeout(()=>{emailRef.current.focus();},100);}},[isOpen]);const handleEmailChange=useCallback(e=>{setLoginData(prev=>({...prev,email:e.target.value}));},[]);const handlePasswordChange=useCallback(e=>{setLoginData(prev=>({...prev,password:e.target.value}));},[]);const handleSubmit=async e=>{e.preventDefault();setAuthError('');if(!loginData.email||!loginData.password){setAuthError('Please fill in all fields');return;}try{const response=await axios.post('/auth/login',{email:loginData.email,password:loginData.password});if(response.data.success){localStorage.setItem('weKnowAuthToken',response.data.access_token);localStorage.setItem('weKnowUser',JSON.stringify(response.data.user));onLogin();setLoginData({email:'',password:''});}else{setAuthError(response.data.error||'Login failed');}}catch(err){var _err$response,_err$response$data;console.error('Login error:',err);if((_err$response=err.response)!==null&&_err$response!==void 0&&(_err$response$data=_err$response.data)!==null&&_err$response$data!==void 0&&_err$response$data.error){setAuthError(err.response.data.error);}else{setAuthError('Failed to connect to the server. Please try again.');}}};if(!isOpen)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"auth-modal\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"close-button\",onClick:onClose,children:\"\\xD7\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"Email\",value:loginData.email,onChange:handleEmailChange,required:true,autoComplete:\"email\",ref:emailRef})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Password\",value:loginData.password,onChange:handlePasswordChange,required:true,autoComplete:\"current-password\",ref:passwordRef})}),authError&&/*#__PURE__*/_jsx(\"div\",{className:\"auth-error\",children:authError}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"auth-submit-button\",children:\"Login\"})]})]})},\"login-modal\");};export default LoginModal;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","axios","jsx","_jsx","jsxs","_jsxs","LoginModal","_ref","isOpen","onClose","onLogin","loginData","setLoginData","email","password","authError","setAuthError","emailRef","passwordRef","current","setTimeout","focus","handleEmailChange","e","prev","target","value","handlePasswordChange","handleSubmit","preventDefault","response","post","data","success","localStorage","setItem","access_token","JSON","stringify","user","error","err","_err$response","_err$response$data","console","className","children","onClick","onSubmit","type","placeholder","onChange","required","autoComplete","ref"],"sources":["/Users/roshan/Desktop/we knowsample/frontend/src/components/LoginModal.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport axios from 'axios';\n\nconst LoginModal = ({ isOpen, onClose, onLogin }) => {\n  const [loginData, setLoginData] = useState({ email: '', password: '' });\n  const [authError, setAuthError] = useState('');\n  const emailRef = useRef(null);\n  const passwordRef = useRef(null);\n\n  useEffect(() => {\n    if (isOpen && emailRef.current) {\n      setTimeout(() => {\n        emailRef.current.focus();\n      }, 100);\n    }\n  }, [isOpen]);\n\n  const handleEmailChange = useCallback((e) => {\n    setLoginData(prev => ({...prev, email: e.target.value}));\n  }, []);\n\n  const handlePasswordChange = useCallback((e) => {\n    setLoginData(prev => ({...prev, password: e.target.value}));\n  }, []);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setAuthError('');\n    \n    if (!loginData.email || !loginData.password) {\n      setAuthError('Please fill in all fields');\n      return;\n    }\n\n    try {\n      const response = await axios.post('/auth/login', {\n        email: loginData.email,\n        password: loginData.password\n      });\n\n      if (response.data.success) {\n        localStorage.setItem('weKnowAuthToken', response.data.access_token);\n        localStorage.setItem('weKnowUser', JSON.stringify(response.data.user));\n        onLogin();\n        setLoginData({ email: '', password: '' });\n      } else {\n        setAuthError(response.data.error || 'Login failed');\n      }\n    } catch (err) {\n      console.error('Login error:', err);\n      if (err.response?.data?.error) {\n        setAuthError(err.response.data.error);\n      } else {\n        setAuthError('Failed to connect to the server. Please try again.');\n      }\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"modal-overlay\" key=\"login-modal\">\n      <div className=\"auth-modal\">\n        <button className=\"close-button\" onClick={onClose}>Ã—</button>\n        <h2>Login</h2>\n        <form onSubmit={handleSubmit}>\n          <div className=\"form-group\">\n            <input\n              type=\"email\"\n              placeholder=\"Email\"\n              value={loginData.email}\n              onChange={handleEmailChange}\n              required\n              autoComplete=\"email\"\n              ref={emailRef}\n            />\n          </div>\n          <div className=\"form-group\">\n            <input\n              type=\"password\"\n              placeholder=\"Password\"\n              value={loginData.password}\n              onChange={handlePasswordChange}\n              required\n              autoComplete=\"current-password\"\n              ref={passwordRef}\n            />\n          </div>\n          {authError && <div className=\"auth-error\">{authError}</div>}\n          <button type=\"submit\" className=\"auth-submit-button\">Login</button>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default LoginModal; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}