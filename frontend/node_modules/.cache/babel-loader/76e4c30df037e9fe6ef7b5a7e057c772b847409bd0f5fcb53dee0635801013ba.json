{"ast":null,"code":"// Grocery Cart Service - Handles cart operations for different grocery apps\n\nclass GroceryCartService {\n  constructor() {\n    this.apps = {\n      blinkit: {\n        name: 'Blinkit',\n        webCartUrl: 'https://blinkit.com/cart',\n        appDeepLink: 'blinkit://cart',\n        searchUrl: 'https://blinkit.com/search?q=',\n        hasPublicAPI: false\n      },\n      zepto: {\n        name: 'Zepto',\n        webCartUrl: 'https://www.zepto.in/cart',\n        appDeepLink: 'zepto://cart',\n        searchUrl: 'https://www.zepto.in/search?q=',\n        hasPublicAPI: false\n      },\n      bigbasket: {\n        name: 'BigBasket',\n        webCartUrl: 'https://www.bigbasket.com/cart',\n        appDeepLink: 'bigbasket://cart',\n        searchUrl: 'https://www.bigbasket.com/ps/?q=',\n        hasPublicAPI: false\n      }\n    };\n  }\n\n  // Add ingredients to cart using the best available method\n  async addToCart(appKey, ingredients) {\n    const app = this.apps[appKey];\n    if (!app) {\n      throw new Error(`Unknown grocery app: ${appKey}`);\n    }\n    try {\n      // Method 1: Try mobile app deep link first\n      if (this.isMobileDevice()) {\n        const deepLinkSuccess = await this.tryDeepLink(app.appDeepLink);\n        if (deepLinkSuccess) {\n          return {\n            success: true,\n            method: 'deep-link',\n            message: `Opened ${app.name} app`\n          };\n        }\n      }\n\n      // Method 2: Try web cart with search parameters\n      const webCartSuccess = await this.addToWebCart(app, ingredients);\n      if (webCartSuccess) {\n        return {\n          success: true,\n          method: 'web-cart',\n          message: `Added to ${app.name} web cart`\n        };\n      }\n\n      // Method 3: Fallback to search page\n      return this.fallbackToSearch(app, ingredients);\n    } catch (error) {\n      console.error(`Error adding to ${app.name} cart:`, error);\n      return this.fallbackToSearch(app, ingredients);\n    }\n  }\n\n  // Check if user is on mobile device\n  isMobileDevice() {\n    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n  }\n\n  // Try to open mobile app via deep link\n  async tryDeepLink(deepLink) {\n    return new Promise(resolve => {\n      const timeout = setTimeout(() => {\n        resolve(false);\n      }, 2000);\n      const originalHref = window.location.href;\n      window.location.href = deepLink;\n\n      // Check if app opened (user left the page)\n      setTimeout(() => {\n        if (window.location.href !== originalHref) {\n          clearTimeout(timeout);\n          resolve(true);\n        }\n      }, 1000);\n    });\n  }\n\n  // Add items to web cart using URL parameters\n  async addToWebCart(app, ingredients) {\n    try {\n      // Create cart URL with ingredients as search parameters\n      const ingredientParams = ingredients.map(ingredient => {\n        const name = typeof ingredient === 'string' ? ingredient : ingredient.ingredient || ingredient.name || '';\n        return encodeURIComponent(name);\n      }).join('&item=');\n      const cartUrl = `${app.webCartUrl}?add=${ingredientParams}`;\n\n      // Open cart page in new tab\n      window.open(cartUrl, '_blank', 'noopener,noreferrer');\n      return true;\n    } catch (error) {\n      console.error('Error adding to web cart:', error);\n      return false;\n    }\n  }\n\n  // Fallback to search page\n  fallbackToSearch(app, ingredients) {\n    const searchQuery = ingredients.map(ingredient => {\n      const name = typeof ingredient === 'string' ? ingredient : ingredient.ingredient || ingredient.name || '';\n      return name;\n    }).join(' ');\n    const searchUrl = `${app.searchUrl}${encodeURIComponent(searchQuery)}`;\n    window.open(searchUrl, '_blank', 'noopener,noreferrer');\n    return {\n      success: true,\n      method: 'search-fallback',\n      message: `Opened ${app.name} search page`\n    };\n  }\n\n  // Get cart status for an app\n  async getCartStatus(appKey) {\n    const app = this.apps[appKey];\n    if (!app) {\n      return {\n        available: false,\n        message: 'App not supported'\n      };\n    }\n    return {\n      available: true,\n      hasApp: this.isMobileDevice(),\n      hasWebCart: true,\n      message: `${app.name} cart is available`\n    };\n  }\n\n  // Get all available apps\n  getAvailableApps() {\n    return Object.keys(this.apps).map(key => ({\n      key,\n      ...this.apps[key]\n    }));\n  }\n}\nexport default new GroceryCartService();","map":{"version":3,"names":["GroceryCartService","constructor","apps","blinkit","name","webCartUrl","appDeepLink","searchUrl","hasPublicAPI","zepto","bigbasket","addToCart","appKey","ingredients","app","Error","isMobileDevice","deepLinkSuccess","tryDeepLink","success","method","message","webCartSuccess","addToWebCart","fallbackToSearch","error","console","test","navigator","userAgent","deepLink","Promise","resolve","timeout","setTimeout","originalHref","window","location","href","clearTimeout","ingredientParams","map","ingredient","encodeURIComponent","join","cartUrl","open","searchQuery","getCartStatus","available","hasApp","hasWebCart","getAvailableApps","Object","keys","key"],"sources":["/Users/roshan/Desktop/we knowsample/frontend/src/components/GroceryCartService.js"],"sourcesContent":["// Grocery Cart Service - Handles cart operations for different grocery apps\n\nclass GroceryCartService {\n  constructor() {\n    this.apps = {\n      blinkit: {\n        name: 'Blinkit',\n        webCartUrl: 'https://blinkit.com/cart',\n        appDeepLink: 'blinkit://cart',\n        searchUrl: 'https://blinkit.com/search?q=',\n        hasPublicAPI: false\n      },\n      zepto: {\n        name: 'Zepto',\n        webCartUrl: 'https://www.zepto.in/cart',\n        appDeepLink: 'zepto://cart',\n        searchUrl: 'https://www.zepto.in/search?q=',\n        hasPublicAPI: false\n      },\n      bigbasket: {\n        name: 'BigBasket',\n        webCartUrl: 'https://www.bigbasket.com/cart',\n        appDeepLink: 'bigbasket://cart',\n        searchUrl: 'https://www.bigbasket.com/ps/?q=',\n        hasPublicAPI: false\n      }\n    };\n  }\n\n  // Add ingredients to cart using the best available method\n  async addToCart(appKey, ingredients) {\n    const app = this.apps[appKey];\n    if (!app) {\n      throw new Error(`Unknown grocery app: ${appKey}`);\n    }\n\n    try {\n      // Method 1: Try mobile app deep link first\n      if (this.isMobileDevice()) {\n        const deepLinkSuccess = await this.tryDeepLink(app.appDeepLink);\n        if (deepLinkSuccess) {\n          return { success: true, method: 'deep-link', message: `Opened ${app.name} app` };\n        }\n      }\n\n      // Method 2: Try web cart with search parameters\n      const webCartSuccess = await this.addToWebCart(app, ingredients);\n      if (webCartSuccess) {\n        return { success: true, method: 'web-cart', message: `Added to ${app.name} web cart` };\n      }\n\n      // Method 3: Fallback to search page\n      return this.fallbackToSearch(app, ingredients);\n\n    } catch (error) {\n      console.error(`Error adding to ${app.name} cart:`, error);\n      return this.fallbackToSearch(app, ingredients);\n    }\n  }\n\n  // Check if user is on mobile device\n  isMobileDevice() {\n    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n  }\n\n  // Try to open mobile app via deep link\n  async tryDeepLink(deepLink) {\n    return new Promise((resolve) => {\n      const timeout = setTimeout(() => {\n        resolve(false);\n      }, 2000);\n\n      const originalHref = window.location.href;\n      \n      window.location.href = deepLink;\n      \n      // Check if app opened (user left the page)\n      setTimeout(() => {\n        if (window.location.href !== originalHref) {\n          clearTimeout(timeout);\n          resolve(true);\n        }\n      }, 1000);\n    });\n  }\n\n  // Add items to web cart using URL parameters\n  async addToWebCart(app, ingredients) {\n    try {\n      // Create cart URL with ingredients as search parameters\n      const ingredientParams = ingredients.map(ingredient => {\n        const name = typeof ingredient === 'string' \n          ? ingredient \n          : ingredient.ingredient || ingredient.name || '';\n        return encodeURIComponent(name);\n      }).join('&item=');\n\n      const cartUrl = `${app.webCartUrl}?add=${ingredientParams}`;\n      \n      // Open cart page in new tab\n      window.open(cartUrl, '_blank', 'noopener,noreferrer');\n      \n      return true;\n    } catch (error) {\n      console.error('Error adding to web cart:', error);\n      return false;\n    }\n  }\n\n  // Fallback to search page\n  fallbackToSearch(app, ingredients) {\n    const searchQuery = ingredients.map(ingredient => {\n      const name = typeof ingredient === 'string' \n        ? ingredient \n        : ingredient.ingredient || ingredient.name || '';\n      return name;\n    }).join(' ');\n\n    const searchUrl = `${app.searchUrl}${encodeURIComponent(searchQuery)}`;\n    window.open(searchUrl, '_blank', 'noopener,noreferrer');\n    \n    return { \n      success: true, \n      method: 'search-fallback', \n      message: `Opened ${app.name} search page` \n    };\n  }\n\n  // Get cart status for an app\n  async getCartStatus(appKey) {\n    const app = this.apps[appKey];\n    if (!app) {\n      return { available: false, message: 'App not supported' };\n    }\n\n    return {\n      available: true,\n      hasApp: this.isMobileDevice(),\n      hasWebCart: true,\n      message: `${app.name} cart is available`\n    };\n  }\n\n  // Get all available apps\n  getAvailableApps() {\n    return Object.keys(this.apps).map(key => ({\n      key,\n      ...this.apps[key]\n    }));\n  }\n}\n\nexport default new GroceryCartService(); "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}